<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1592px" preserveAspectRatio="none" style="width:684px;height:1592px;" version="1.1" viewBox="0 0 684 1592" width="684px" zoomAndPan="magnify"><defs><filter height="300%" id="fj0qcthqb0orq" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="372" x2="372" y1="38.2969" y2="1551.8594"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="428" x2="428" y1="38.2969" y2="1551.8594"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="535" x2="535" y1="38.2969" y2="1551.8594"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="638" x2="638" y1="38.2969" y2="1551.8594"/><rect fill="#FEFECE" filter="url(#fj0qcthqb0orq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="46" x="347" y="3"/><text fill="#000000" font-family="Helvetica" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="354" y="22.9951">User</text><rect fill="#FEFECE" filter="url(#fj0qcthqb0orq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="46" x="347" y="1550.8594"/><text fill="#000000" font-family="Helvetica" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="354" y="1570.8545">User</text><rect fill="#FEFECE" filter="url(#fj0qcthqb0orq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="38" x="407" y="3"/><text fill="#000000" font-family="Helvetica" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="24" x="414" y="22.9951">MM</text><rect fill="#FEFECE" filter="url(#fj0qcthqb0orq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="38" x="407" y="1550.8594"/><text fill="#000000" font-family="Helvetica" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="24" x="414" y="1570.8545">MM</text><rect fill="#FEFECE" filter="url(#fj0qcthqb0orq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="504" y="3"/><text fill="#000000" font-family="Helvetica" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="511" y="22.9951">Kernel</text><rect fill="#FEFECE" filter="url(#fj0qcthqb0orq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="504" y="1550.8594"/><text fill="#000000" font-family="Helvetica" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="511" y="1570.8545">Kernel</text><rect fill="#FEFECE" filter="url(#fj0qcthqb0orq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="599" y="3"/><text fill="#000000" font-family="Helvetica" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="606" y="22.9951">Sys_task</text><rect fill="#FEFECE" filter="url(#fj0qcthqb0orq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="599" y="1550.8594"/><text fill="#000000" font-family="Helvetica" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="606" y="1570.8545">Sys_task</text><path d="M90,53.2969 L90,138.2969 L363,138.2969 L363,63.2969 L353,53.2969 L90,53.2969 " fill="#FBFB77" filter="url(#fj0qcthqb0orq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M353,53.2969 L353,63.2969 L363,63.2969 L353,53.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="96" y="70.3638">lib.a/fork.c:</text><a href="http://localhost:8001/lib/fork.c" target="_top" title="http://localhost:8001/lib/fork.c" xlink:actuate="onRequest" xlink:href="http://localhost:8001/lib/fork.c" xlink:show="new" xlink:title="http://localhost:8001/lib/fork.c" xlink:type="simple"><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="30" x="181" y="70.3638">fork</text></a><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="211" y="70.3638">()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="104" y="85.4966"/><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="104" y="85.4966">call.c:</text><a href="http://localhost:8001/lib/call.c" target="_top" title="http://localhost:8001/lib/call.c" xlink:actuate="onRequest" xlink:href="http://localhost:8001/lib/call.c" xlink:show="new" xlink:title="http://localhost:8001/lib/call.c" xlink:type="simple"><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="48" x="147" y="85.4966">callm1</text></a><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="195" y="85.4966">(MM,id=syscallnr)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="112" y="100.6294"/><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="33" x="112" y="100.6294">callx</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="145" y="100.6294">(MM,id)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="120" y="115.7622">m_ptr-&gt;m_type=id</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="120" y="130.895">k=</text><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="138" y="130.895">sendrec.s:</text><a href="http://localhost:8000/IPC/#system-call" target="_top" title="http://localhost:8000/IPC/#system-call" xlink:actuate="onRequest" xlink:href="http://localhost:8000/IPC/#system-call" xlink:show="new" xlink:title="http://localhost:8000/IPC/#system-call" xlink:type="simple"><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="59" x="215" y="130.895">sendrec</text></a><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="274" y="130.895">(MM,m_ptr)</text><polygon fill="#A80036" points="523,165.0938,533,169.0938,523,173.0938,527,169.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="372" x2="529" y1="169.0938" y2="169.0938"/><text fill="#0000FF" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="383" y="164.0278">INT SYSVEC</text><path d="M236,182.0938 L236,418.0938 L526,418.0938 L526,192.0938 L516,182.0938 L236,182.0938 " fill="#FBFB77" filter="url(#fj0qcthqb0orq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M516,182.0938 L516,192.0938 L526,192.0938 L516,182.0938 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="242" y="199.1606">mpx88.s:</text><a href="http://localhost:8000/IPC/#kernel-call" target="_top" title="http://localhost:8000/IPC/#kernel-call" xlink:actuate="onRequest" xlink:href="http://localhost:8000/IPC/#kernel-call" xlink:show="new" xlink:title="http://localhost:8000/IPC/#kernel-call" xlink:type="simple"><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="40" x="310" y="199.1606">s_call</text></a><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="250" y="214.2935">call</text><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="275" y="214.2935">proc.c:</text><a href="http://localhost:8001/kernel/proc.c" target="_top" title="http://localhost:8001/kernel/proc.c" xlink:actuate="onRequest" xlink:href="http://localhost:8001/kernel/proc.c" xlink:show="new" xlink:title="http://localhost:8001/kernel/proc.c" xlink:type="simple"><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="56" x="326" y="214.2935">sys_call</text></a><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="382" y="214.2935">(BOTH,id,MM,m_ptr)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="258" y="229.4263"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67" x="258" y="229.4263">minisend</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="325" y="229.4263">()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="266" y="244.5591"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="64" x="266" y="244.5591">cp_mess</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="330" y="244.5591">(m_ptr,MM-&gt;p_messbuf)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="266" y="259.6919"/><text fill="#FF0000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="266" y="259.6919">ready</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="308" y="259.6919">(MM)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="258" y="274.8247"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="61" x="258" y="274.8247">mini_rec</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="319" y="274.8247">()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="266" y="289.9575">id-&gt;p_getfrom = MM</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="266" y="305.0903">id-&gt;p_flags |= RECEIVING</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="266" y="320.2231"/><text fill="#FF0000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="266" y="320.2231">unready</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="326" y="320.2231">(id)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="274" y="335.356">rdy_head[2]=id-&gt;p_nextready</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="274" y="350.4888"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="274" y="350.4888">pick_proc</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="345" y="350.4888">()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="282" y="365.6216"/><text fill="#FF0000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="282" y="365.6216">proc_ptr=rdy_head[1];//MM</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="266" y="380.7544"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="48" x="266" y="380.7544">inform</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="314" y="380.7544">(MM_PROC_NR)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="250" y="395.8872">jmp</text><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="278" y="395.8872">mpx88.s:</text><a href="http://localhost:8000/IPC/#restart" target="_top" title="http://localhost:8000/IPC/#restart" xlink:actuate="onRequest" xlink:href="http://localhost:8000/IPC/#restart" xlink:show="new" xlink:title="http://localhost:8000/IPC/#restart" xlink:type="simple"><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="50" x="346" y="395.8872">restart</text></a><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="258" y="411.02">mov sp,_proc_ptr,push cs,push pc</text><polygon fill="#A80036" points="439,445.2188,429,449.2188,439,453.2188,435,449.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="433" x2="534" y1="449.2188" y2="449.2188"/><text fill="#0000FF" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="445" y="444.1528">iret</text><path d="M73,462.2188 L73,608.2188 L419,608.2188 L419,472.2188 L409,462.2188 L73,462.2188 " fill="#FBFB77" filter="url(#fj0qcthqb0orq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M409,462.2188 L409,472.2188 L419,472.2188 L409,462.2188 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="87" x="79" y="479.2856">mm/main.c:</text><a href="http://localhost:8001/mm/main.c" target="_top" title="http://localhost:8001/mm/main.c" xlink:actuate="onRequest" xlink:href="http://localhost:8001/mm/main.c" xlink:show="new" xlink:title="http://localhost:8001/mm/main.c" xlink:type="simple"><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="36" x="166" y="479.2856">main</text></a><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="202" y="479.2856">()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="95" y="494.4185"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="95" y="494.4185">get_work</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="163" y="494.4185">()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="103" y="509.5513">who=pid</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="103" y="524.6841">mm_call=FORK</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="95" y="539.8169">call_vec[mm_call]</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="95" y="554.9497">=&gt;</text><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="108" x="121" y="554.9497">mm/forkexit.c:</text><a href="http://localhost:8001/mm/forkexit.c" target="_top" title="http://localhost:8001/mm/forkexit.c" xlink:actuate="onRequest" xlink:href="http://localhost:8001/mm/forkexit.c" xlink:show="new" xlink:title="http://localhost:8001/mm/forkexit.c" xlink:type="simple"><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="56" x="229" y="554.9497">do_fork</text></a><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="285" y="554.9497">()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="103" y="570.0825">mproc[pid].mp_pid=new_pid</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="103" y="585.2153"/><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="103" y="585.2153">lib.a/syslib.c:</text><a href="http://localhost:8001/lib/syslib.c" target="_top" title="http://localhost:8001/lib/syslib.c" xlink:actuate="onRequest" xlink:href="http://localhost:8001/lib/syslib.c" xlink:show="new" xlink:title="http://localhost:8001/lib/syslib.c" xlink:type="simple"><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="61" x="200" y="585.2153">sys_fork</text></a><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="261" y="585.2153">(who,child_nr,new_pid)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="111" y="600.3481"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="111" y="600.3481">call.c:callm1</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="202" y="600.3481">(SYSTASK,SYS_FORK)</text><polygon fill="#A80036" points="523,634.5469,533,638.5469,523,642.5469,527,638.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="428" x2="529" y1="638.5469" y2="638.5469"/><text fill="#0000FF" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="439" y="633.481">INT SYSVEC</text><path d="M236,651.5469 L236,751.5469 L526,751.5469 L526,661.5469 L516,651.5469 L236,651.5469 " fill="#FBFB77" filter="url(#fj0qcthqb0orq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M516,651.5469 L516,661.5469 L526,661.5469 L516,651.5469 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="242" y="668.6138">mpx88.s:</text><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="310" y="668.6138">s_call</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="250" y="683.7466">call</text><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="275" y="683.7466">proc.c:</text><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="326" y="683.7466">sys_call</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="382" y="683.7466">(BOTH,id,MM,m_ptr)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="258" y="698.8794"/><text fill="#FF0000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="258" y="698.8794">ready(SYSTASK)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="258" y="714.0122"/><text fill="#FF0000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="258" y="714.0122">unready(MM)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="266" y="729.145"/><text fill="#FF0000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="266" y="729.145">proc_ptr=rdy_head[0];//SYSTASK</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="250" y="744.2778">jmp</text><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="278" y="744.2778">mpx88.s/restart</text><polygon fill="#A80036" points="626,778.4766,636,782.4766,626,786.4766,630,782.4766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="535" x2="632" y1="782.4766" y2="782.4766"/><text fill="#0000FF" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="546" y="777.4106">iret</text><path d="M379,795.4766 L379,835.4766 L629,835.4766 L629,805.4766 L619,795.4766 L379,795.4766 " fill="#FBFB77" filter="url(#fj0qcthqb0orq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M619,795.4766 L619,805.4766 L629,805.4766 L619,795.4766 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="122" x="385" y="812.5435">kernel/system.c:</text><a href="http://localhost:8001/kernel/system.c" target="_top" title="http://localhost:8001/kernel/system.c" xlink:actuate="onRequest" xlink:href="http://localhost:8001/kernel/system.c" xlink:show="new" xlink:title="http://localhost:8001/kernel/system.c" xlink:type="simple"><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="63" x="507" y="812.5435">sys_task</text></a><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="570" y="812.5435">()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="393" y="827.6763"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="153" x="393" y="827.6763">lib/sendrec.s:receive</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="546" y="827.6763">(ANY, &amp;m)</text><polygon fill="#A80036" points="546,861.875,536,865.875,546,869.875,542,865.875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="540" x2="637" y1="865.875" y2="865.875"/><text fill="#0000FF" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="556" y="860.8091">INT SYSVEC</text><path d="M342,878.875 L342,948.875 L526,948.875 L526,888.875 L516,878.875 L342,878.875 " fill="#FBFB77" filter="url(#fj0qcthqb0orq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M516,878.875 L516,888.875 L526,888.875 L516,878.875 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="158" x="348" y="895.9419">kernel/proc.c:sys_call</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="356" y="911.0747"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="61" x="356" y="911.0747">mini_rec</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="417" y="911.0747">()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="364" y="926.2075"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="64" x="364" y="926.2075">cp_mess</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="428" y="926.2075">(..);</text><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="450" y="926.2075">return</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="499" y="926.2075">0;</text><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="348" y="941.3403">mpx88.s:restart</text><polygon fill="#A80036" points="626,975.5391,636,979.5391,626,983.5391,630,979.5391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="535" x2="632" y1="979.5391" y2="979.5391"/><text fill="#0000FF" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="546" y="974.4731">iret</text><path d="M352,992.5391 L352,1062.5391 L629,1062.5391 L629,1002.5391 L619,992.5391 L352,992.5391 " fill="#FBFB77" filter="url(#fj0qcthqb0orq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M619,992.5391 L619,1002.5391 L629,1002.5391 L619,992.5391 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="358" y="1009.606">switch (m.m_type)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="366" y="1024.7388">case SYS_FORK :</text><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="477" y="1024.7388">system.c:</text><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="548" y="1024.7388">do_fork</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="604" y="1024.7388">()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="374" y="1039.8716">//copy parent proc struct</text><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="136" x="358" y="1055.0044">lib/sendrec.s:send</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="494" y="1055.0044">(MM)</text><polygon fill="#A80036" points="546,1089.2031,536,1093.2031,546,1097.2031,542,1093.2031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="540" x2="637" y1="1093.2031" y2="1093.2031"/><text fill="#0000FF" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="556" y="1088.1372">INT SYSVEC</text><path d="M329,1106.2031 L329,1191.2031 L629,1191.2031 L629,1116.2031 L619,1106.2031 L329,1106.2031 " fill="#FBFB77" filter="url(#fj0qcthqb0orq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M619,1106.2031 L619,1116.2031 L629,1116.2031 L619,1106.2031 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="279" x="335" y="1123.27">mpx88.s:s_call =&gt; system.c:sys_call()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="343" y="1138.4028"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="74" x="343" y="1138.4028">mini_send</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="417" y="1138.4028">()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="351" y="1153.5356"/><text fill="#FF0000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="351" y="1153.5356">unready</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="411" y="1153.5356">(SYS_TASK)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="359" y="1168.6685"/><text fill="#FF0000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="359" y="1168.6685">proc_ptr=rdy_head[1];//MM</text><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="335" y="1183.8013">mpx88.s:restart</text><polygon fill="#A80036" points="439,1218,429,1222,439,1226,435,1222" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="433" x2="534" y1="1222" y2="1222"/><text fill="#0000FF" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="449" y="1216.9341">iret</text><path d="M129,1235 L129,1290 L419,1290 L419,1245 L409,1235 L129,1235 " fill="#FBFB77" filter="url(#fj0qcthqb0orq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M409,1235 L409,1245 L419,1245 L409,1235 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="103" x="135" y="1252.0669">mm/forkexit.c</text><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="238" y="1252.0669">do_fork</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="294" y="1252.0669">()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="143" y="1267.1997"/><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92" x="143" y="1267.1997">mm/main.c::</text><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="235" y="1267.1997">reply</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="272" y="1267.1997">(child_nr,0)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="151" y="1282.3325"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="136" x="151" y="1282.3325">lib/sendrec.s:send</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="287" y="1282.3325">(child_nr,mm_out)</text><polygon fill="#A80036" points="523,1316.5313,533,1320.5313,523,1324.5313,527,1320.5313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="428" x2="529" y1="1320.5313" y2="1320.5313"/><text fill="#0000FF" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="439" y="1315.4653">INT SYSVEC</text><path d="M226,1333.5313 L226,1418.5313 L526,1418.5313 L526,1343.5313 L516,1333.5313 L226,1333.5313 " fill="#FBFB77" filter="url(#fj0qcthqb0orq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M516,1333.5313 L516,1343.5313 L526,1343.5313 L516,1333.5313 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="279" x="232" y="1350.5981">mpx88.s:s_call =&gt; system.c:sys_call()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="240" y="1365.731"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="74" x="240" y="1365.731">mini_send</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="314" y="1365.731">()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="248" y="1380.8638"/><text fill="#FF0000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="248" y="1380.8638">unready(MM)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="248" y="1395.9966"/><text fill="#000000" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="248" y="1395.9966">pick_proc</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="319" y="1395.9966">()</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="256" y="1411.1294"/><text fill="#FF0000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="256" y="1411.1294">proc_ptr=child_nr??</text><polygon fill="#A80036" points="383,1445.3281,373,1449.3281,383,1453.3281,379,1449.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="377" x2="534" y1="1449.3281" y2="1449.3281"/><text fill="#0000FF" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="393" y="1444.2622">iret</text><path d="M8,1462.3281 L8,1532.3281 L363,1532.3281 L363,1472.3281 L353,1462.3281 L8,1462.3281 " fill="#FBFB77" filter="url(#fj0qcthqb0orq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M353,1462.3281 L353,1472.3281 L363,1472.3281 L353,1462.3281 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#006400" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="66" x="14" y="1479.395">lib/call.c:</text><text fill="#0000FF" font-family="Helvetica" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="33" x="80" y="1479.395">callx</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="113" y="1479.395">(MM,id)</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="22" y="1494.5278">if k!=OK return(k);</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="326" x="22" y="1509.6606">if (M.m_type &lt; 0) {errno = -M.m_type; return(-1);}</text><text fill="#000000" font-family="Helvetica" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="22" y="1524.7935">return M.m_type;</text><!--MD5=[ba3ac5178b025291baa9e5de8ba3b5c4]
@startuml
participant User
participant MM
participant Kernel
participant Sys_task
skinparam defaultFontName Helvetica


note left of User
**<color darkgreen>lib.a/fork.c:[[http://localhost:8001/lib/fork.c fork]]**()
  **<color darkgreen>call.c:[[http://localhost:8001/lib/call.c callm1]]**(MM,id=syscallnr)
    **<color blue>callx**(MM,id)
      m_ptr->m_type=id
      k=**<color darkgreen>sendrec.s:<color blue>[[http://localhost:8000/IPC/#system-call sendrec]]</color>**(MM,m_ptr)
end note

User->Kernel:<color blue> INT SYSVEC</color>
note left of Kernel
**<color darkgreen>mpx88.s:[[http://localhost:8000/IPC/#kernel-call s_call]]**
  call **<color darkgreen>proc.c:[[http://localhost:8001/kernel/proc.c sys_call]]**(BOTH,id,MM,m_ptr)
    **minisend**()
      **cp_mess**(m_ptr,MM->p_messbuf)
      **<color red>ready**(MM)
    **mini_rec**()
      id->p_getfrom = MM
      id->p_flags |= RECEIVING
      **<color red>unready**(id)
        rdy_head[2]=id->p_nextready
        **pick_proc**()
          <color red>proc_ptr=rdy_head[1];//MM
      **inform**(MM_PROC_NR)
  jmp **<color darkgreen>mpx88.s:<color blue>[[http://localhost:8000/IPC/#restart restart]]**
    mov sp,_proc_ptr,push cs,push pc
end note



Kernel->MM:<color blue>iret</color>
note left of MM
**<color darkgreen>mm/main.c:[[http://localhost:8001/mm/main.c main]]**()
    **get_work**()
      who=pid
      mm_call=FORK
    call_vec[mm_call]
    => **<color darkgreen>mm/forkexit.c:[[http://localhost:8001/mm/forkexit.c do_fork]]**()
      mproc[pid].mp_pid=new_pid
      **<color darkgreen>lib.a/syslib.c:[[http://localhost:8001/lib/syslib.c sys_fork]]**(who,child_nr,new_pid)
        **call.c:callm1**(SYSTASK,SYS_FORK)
end note

MM->Kernel:<color blue> INT SYSVEC</color>
note left of Kernel
**<color darkgreen>mpx88.s:<color blue>s_call**
  call **<color darkgreen>proc.c:<color blue>sys_call**(BOTH,id,MM,m_ptr)
    **<color red>ready(SYSTASK)**
    **<color red>unready(MM)**
      <color red>proc_ptr=rdy_head[0];//SYSTASK
  jmp **<color blue>mpx88.s/restart**
end note



Kernel->Sys_task:<color blue> iret</color>
note left of Sys_task
**<color darkgreen>kernel/system.c:[[http://localhost:8001/kernel/system.c sys_task ]]**()
  **lib/sendrec.s:receive**(ANY, &m)
end note

Sys_task->Kernel:<color blue> INT SYSVEC</color>
note left of Kernel
  **kernel/proc.c:sys_call**
    **mini_rec**()
      **cp_mess**(..);**return** 0;
  **mpx88.s:restart**
end note

Kernel->Sys_task:<color blue> iret</color>
note left of Sys_task
switch (m.m_type)
  case SYS_FORK : **<color darkgreen>system.c:<color blue>do_fork**()
    //copy parent proc struct
**lib/sendrec.s:send**(MM)
end note
Sys_task->Kernel:<color blue> INT SYSVEC</color>


note left of Sys_task
**mpx88.s:s_call => system.c:sys_call()**
  **mini_send**()
    **<color red>unready**(SYS_TASK)
      <color red>proc_ptr=rdy_head[1];//MM
**mpx88.s:restart**
end note


Kernel->MM:<color blue> iret </color>
note left of MM
**<color darkgreen>mm/forkexit.c<color blue>do_fork**()
  **<color darkgreen>mm/main.c::<color blue>reply**(child_nr,0)
    **lib/sendrec.s:send**(child_nr,mm_out)
end note
MM->Kernel:<color blue> INT SYSVEC </color>
note left of Kernel
**mpx88.s:s_call => system.c:sys_call()**
  **mini_send**()
    **<color red>unready(MM)**
    **pick_proc**()
      <color red>proc_ptr=child_nr??
end note


Kernel->User:<color blue> iret </color>
note left of User
**<color darkgreen>lib/call.c:<color blue>callx**(MM,id)
  if k!=OK return(k);
  if (M.m_type < 0) {errno = -M.m_type; return(-1);}
  return M.m_type;
end note


@enduml

PlantUML version 1.2019.11(Sun Sep 22 11:02:15 BST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.6+10-post-Ubuntu-1ubuntu119.10.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>